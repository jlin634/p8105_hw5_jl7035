---
title: "p8105_hw5_jl7035"
author: "Jeffrey Lin"
date: "2024-11-11"
output: github_document
---

# Load Libraries
```{r}
library(tidyverse)

```


# Problem 1

## Functions for Randomly Drawing Birthdays and calculating prob of duplicates

```{r}
dup_bdays = function(samp_size) {
  bday_vec <- sample(c(1:365), size = samp_size, replace = TRUE)

  if (n_distinct(bday_vec) < samp_size) {
    return(TRUE)
  } else {
    return(FALSE)
  } 
  
}


```

## Run Simulations from sample size 2 to 50
```{r}

prob_by_size <- c()

for (sample_size in 2:50){
  num_dups = 0
  for (iteration in 1:10000) {
    if (dup_bdays(sample_size))
      num_dups = num_dups + 1
  }
  
  avg_prob = num_dups / 10000
  
  prob_by_size = append(prob_by_size, values = avg_prob)
}

dup_bday_tbl <-
  tibble(
    sample_size = 2:50,
    avg_prob = prob_by_size
  )

```


## Plot of probability of duplicate birthdays by sample size
```{r}
dup_bday_tbl %>% 
  ggplot(aes(x = sample_size, y = avg_prob)) +
  geom_point() +
  xlab("Sample Size") +
  ylab("Probability of Duplicate Birthdays") +
  ggtitle("Probability of Duplicate Birthdays by Sample Size")


```
As the sample size increases, the probability of duplicate birthdays increases.
The probability of having duplicate birthdays grows above 0.50 around a sample
size of 23. 

# Problem 2


## Generate 5000 datasets for mu = 0 and save p-values
```{r}
n <- 30
sigma <- 5
mu <- 0

x_bar_vec <- c()
p_val_vec <- c()

for (iter in 1:5000) {
  
  
}

```

